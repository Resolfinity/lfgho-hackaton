# ZK GHO Facilitator by Resolfinity

### L2 Flashminter following AAVE Governance limitation from the Mainnet

![Zk-gho-facilitator](https://github.com/Resolfinity/lfgho-hackaton/blob/main/docs/ZK-GHO-Facilitator_logo_512x512.png)

## Demo for LFGHO hackaton

### Description

The Zk Gho Facilitator is our vision of how the GHO Flash Minter on any L2 can work in its original form.

Now, Flash Loans on the Mainnet have a global limitation managed by the AAVE Governance.

The main idea here is to:

- create a zk storage proof of the limitation value from the Mainnet smart contract
- pass it to any desired L2
- verify zk proof against the Mainnet block header.

[LFGHO Project page](https://ethglobal.com/showcase/gho-zk-facilitator-x9rdg)

![Zk-gho-facilitator-scheme](https://github.com/Resolfinity/lfgho-hackaton/blob/main/docs/zk%20gho%20facilitator.png)

## Zk stack

For this project, we've chosen Noir Language.

https://noir-lang.org/

## How to install

Nargo(Noir), Node.js, Npm should be installed.

```
git clone git@github.com:Resolfinity/lfgho-hackaton.git

yarn
```

Copy .env.example to .env and fill in all the vars.

## Tests

To run test, do `npx hardhat test`

## Deploy to the real chain

`npx hardhat run ./scripts/deploy.ts --network mumbai`

It will have deployed three contracts:

- GHOL2 fith some fake FlashMinter address written, having initial 1 GHO bucket cap
- ZkBucketManager which has access to change bucket caps in GHOL2 by calling trustless function with zk-proof
- UltraVerifier which is generated by Nargo prover. It verifies zk-proof, called by ZkBucketManager

## Run Relay to do the job

```
npx ts-node ./relay/index.ts
```

in the terminal you will see logs

- get current mainnet GHO FlashMinter facilitator bucket cap
- compare with Mumbai GHOL2 FlashMinter bucket cap
- get storage proof for bucket slot in L1
- create noir prover inputs
- generate noir proof
- send tx to the ZkBucketManager, which will verify the proof and will update GHOL2 FlashMinter bucket cap

## Contracts already deployed for LFGHO hackaton:

- GHOL2: 0x2AAbf0c3278155c2B83bb32D0506B0D33e7ded4d

- ZkBucketManager: 0xf7fe88598229b44a671abdee2518fac1cf756283

- UltraVerifier: 0x67bbf96aa8170ab78a43f68816ac647c7e20359e
